### 整数集合

+ **简要：**是集合键的底层实现之一，只有一个集合中都是整数值元素，`Redis`就会使用整数集合作为集合键的底层实现。
+ 是`redis`用于保存整数值的集合抽象数据结构，保存的类型有`int16_t、int32_t、int64_t`的整数值，并且保证集合不会出现重复元素。

### 二、整数集合的实现

+ **定义：**

  ![image-20200914152258868](C:\Users\Administrator\Desktop\Redis详解\imges\image-20200914152258868.png)
  ![image-20200914152547815](C:\Users\Administrator\Desktop\Redis详解\imges\image-20200914152547815.png)

  ​	**注意**：同理32位、64位的整数。

### 三、升级

+ 场景：假设现有的整数集合的所有元素都是 `int_32位的`，此时插入一个 `int64位`的数，此时`Redis`会有哪些操作？
  + 1、首先，根据**新元素的类型，扩展整数集合底层数组的大小**，并为其分配空间。
  + 2、其次，将整数集合的**现有元素都转换成与新元素相同的类型**，并放置到正确的位置上，且`保存原有的有序性质不变`。
  + 3、最后，**将新元素添加到底层数组里面**，因为引起升级操作，说明这个新元素摆放位置只有两种情况：
    + 情况1：新元素`小于`所有现有元素的情况下，新元素放置在底层数组的 `最开头(索引0)`
    + 情况2：新元素`大于`所有现有元素的情况下，新元素放置在底层数组的 `最末尾(索引 length -1)`
+ **好处：**
  + **提升灵活性**   ==>  整数集合可以自动的适应新元素，所以可以随便插入任意类型的整数。
  + **节约内存**  ==>  让一个整数数组保存3个类型的值，最简单的话，就该整数数组类型设置为最大的`int64`位的，但是注意：可能这些集合都是 `int16或者int32`位的话，那么我们设置`int64`就是浪费内存了。所以`Redis`用到`升级操作`,同时可以同时保存三种类型的数据，又可以确保升级操作**只会在需要的时候进行**，这样的尽量节约内存。

### 四、降级

+ 整数集合 **不支持 降级操作**，一旦升级，就会一直保持升级后的状态。
+ **注意：**假设整数集合中只有一个元素是 `int64位`的，其余都是`int32位`的，如果将这个 **`int64`位的删除**了，那么这个整数集合的底层数组**依旧是 `int64`位的。**

### 五、整数集合API

![image-20200914154851846](C:\Users\Administrator\Desktop\Redis详解\imges\image-20200914154851846.png)

### 六、总结

![image-20200914154943887](C:\Users\Administrator\Desktop\Redis详解\imges\image-20200914154943887.png)